<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ExcelBridge_plugin_for_Google_Sheets_using_npm</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="gbpy-for-google-sheets---addendum-to-plugin-developer-guide">GBPY for Google Sheets - Addendum to Plugin Developer Guide</h1>
<h2 id="📊-google-sheets-integration-for-excelbridge">📊 <strong>Google Sheets Integration for ExcelBridge</strong></h2>
<p>This addendum documents how to connect Google Sheets to your local ExcelBridge Python server, enabling GBPY functions to work in Google Sheets exactly as they do in Excel VBA.</p>
<hr>
<h2 id="🔧-prerequisites">🔧 <strong>Prerequisites</strong></h2>

<table>
<thead>
<tr>
<th>Requirement</th>
<th>Version</th>
<th>Check Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Node.js</td>
<td>14.x or higher</td>
<td><code>node --version</code></td>
</tr>
<tr>
<td>npm</td>
<td>6.x or higher</td>
<td><code>npm --version</code></td>
</tr>
<tr>
<td>ExcelBridge Server</td>
<td>2.2.8+</td>
<td>Running on <code>http://127.0.0.1:8765</code></td>
</tr>
<tr>
<td>Google Account</td>
<td>-</td>
<td>Access to Google Sheets</td>
</tr>
</tbody>
</table><hr>
<h2 id="📥-step-1-install-node.js-and-npm">📥 <strong>Step 1: Install Node.js and npm</strong></h2>
<h3 id="windows"><strong>Windows:</strong></h3>
<ol>
<li>Download Node.js installer from <a href="https://nodejs.org">https://nodejs.org</a></li>
<li>Click the <strong>LTS version</strong> (64-bit recommended)</li>
<li>Run the installer:
<ul>
<li>✅ Accept license agreement</li>
<li>✅ Keep default installation path</li>
<li>✅ <strong>IMPORTANT:</strong> Check “Automatically install the necessary tools”</li>
</ul>
</li>
<li>Restart your computer after installation</li>
</ol>
<p><strong>Verify installation:</strong></p>
<pre class=" language-cmd"><code class="prism  language-cmd">node --version
npm --version
</code></pre>
<p>Expected output: <code>v18.x.x</code> or higher, <code>9.x.x</code> or higher</p>
<h3 id="macos"><strong>macOS:</strong></h3>
<pre class=" language-bash"><code class="prism  language-bash">brew <span class="token function">install</span> node
<span class="token comment"># or download from nodejs.org</span>
</code></pre>
<h3 id="linux-ubuntudebian"><strong>Linux (Ubuntu/Debian):</strong></h3>
<pre class=" language-bash"><code class="prism  language-bash">curl -fsSL https://deb.nodesource.com/setup_18.x <span class="token operator">|</span> <span class="token function">sudo</span> -E <span class="token function">bash</span> -
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y nodejs
</code></pre>
<hr>
<h2 id="🚀-step-2-start-your-excelbridge-server">🚀 <strong>Step 2: Start Your ExcelBridge Server</strong></h2>
<h3 id="using-excelbridge.exe-windows---recommended"><strong>Using ExcelBridge.exe (Windows - Recommended):</strong></h3>
<pre class=" language-cmd"><code class="prism  language-cmd"># Navigate to your ExcelBridge installation
cd C:\Users\YourUsername\GenePython\ExcelBridge_v2_2_8_portable

# Start the server
ExcelBridge.exe
</code></pre>
<p><strong>Expected output:</strong></p>
<pre><code>ExcelBridge Server v2.2.8 running on http://127.0.0.1:8765
Press Ctrl+C to stop
</code></pre>
<h3 id="using-python-directly-alternative"><strong>Using Python directly (Alternative):</strong></h3>
<pre class=" language-cmd"><code class="prism  language-cmd">cd C:\Users\YourUsername\GenePython\ExcelBridge_v2_2_8_portable
python excel_bridge_server.py
</code></pre>
<p><strong>✅ KEEP THIS WINDOW OPEN AND RUNNING</strong></p>
<hr>
<h2 id="🌐-step-3-install-and-run-localtunnel-no-installation-required">🌐 <strong>Step 3: Install and Run LocalTunnel (No installation required)</strong></h2>
<p>LocalTunnel creates a public HTTPS URL that forwards requests to your local ExcelBridge server.</p>
<h3 id="open-a-new-command-prompt-window-keep-excelbridge-running"><strong>Open a NEW Command Prompt window</strong> (keep ExcelBridge running)</h3>
<pre class=" language-cmd"><code class="prism  language-cmd"># No installation needed! npx runs it directly
npx localtunnel --port 8765 --subdomain gbpy
</code></pre>
<p><strong>Expected output:</strong></p>
<pre><code>your url is: https://gbpy.loca.lt
</code></pre>
<p><strong>⚠️ IMPORTANT:</strong></p>
<ul>
<li>Keep this window open</li>
<li>If the subdomain “gbpy” is taken, try: <code>gbpy1</code>, <code>gbpy2</code>, <code>excelbridge</code>, etc.</li>
<li>The URL will be used in your Google Apps Script</li>
</ul>
<p><strong>Test the tunnel:</strong></p>
<pre class=" language-cmd"><code class="prism  language-cmd"># In another terminal window
curl https://gbpy.loca.lt/health
</code></pre>
<p>Expected: <code>{"status":"ok","version":"2.2.8",...}</code></p>
<hr>
<h2 id="📝-step-4-google-apps-script---full-code-listing">📝 <strong>Step 4: Google Apps Script - Full Code Listing</strong></h2>
<h3 id="open-google-apps-script"><strong>4.1 Open Google Apps Script</strong></h3>
<ol>
<li>Open your Google Sheet</li>
<li>Click <strong>Extensions → Apps Script</strong></li>
<li>Delete any default code</li>
<li><strong>Paste the entire code block below</strong></li>
</ol>
<h3 id="complete-gbpy-client-code-for-google-sheets"><strong>4.2 Complete GBPY Client Code for Google Sheets</strong></h3>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">/**
 * ============================================
 *  GBPY Client for Google Sheets
 *  ExcelBridge Python Server Connector
 *  Version 2.2.8
 * ============================================
 * 
 * This script connects Google Sheets to your local ExcelBridge Python server
 * through a LocalTunnel HTTPS URL.
 * 
 * AUTHOR: Gene Boo / ExcelBridge Team
 * LICENSE: MIT
 * 
 * USAGE IN GOOGLE SHEETS:
 * =GBPY("plugin.py", "function", arg1, arg2, ...)
 * =GBPY_PING()
 * =GBPY_FUNCTIONS()
 * =GBPY_ARRAY("plugin.py", "function", range)
 * =GBPY_DEBUG("plugin.py", "function", args...)
 */</span>

<span class="token comment">// ============================================</span>
<span class="token comment">// CONFIGURATION - CHANGE THIS TO YOUR TUNNEL URL</span>
<span class="token comment">// ============================================</span>

<span class="token comment">/** 
 * !!! IMPORTANT !!!
 * Replace this URL with the one from your LocalTunnel output:
 * npx localtunnel --port 8765 --subdomain gbpy
 * 
 * Example: https://gbpy.loca.lt
 */</span>
<span class="token keyword">var</span> SERVER_BASE <span class="token operator">=</span> <span class="token string">"https://gbpy.loca.lt"</span><span class="token punctuation">;</span>  <span class="token comment">// ⚠️ CHANGE THIS TO YOUR URL</span>

<span class="token comment">// API Endpoints (do not change)</span>
<span class="token keyword">var</span> INVOKE_PATH <span class="token operator">=</span> <span class="token string">"/invoke"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> INVOKE_EXCEL_ARRAY_PATH <span class="token operator">=</span> <span class="token string">"/invoke/excel_array"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> HEALTH_PATH <span class="token operator">=</span> <span class="token string">"/health"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> FUNCTIONS_PATH <span class="token operator">=</span> <span class="token string">"/functions"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> RELOAD_PATH <span class="token operator">=</span> <span class="token string">"/plugins/reload"</span><span class="token punctuation">;</span>

<span class="token comment">// Cache configuration</span>
<span class="token keyword">var</span> catalogCache <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> lastCatalogUpdate <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> CACHE_TIMEOUT <span class="token operator">=</span> <span class="token number">300000</span><span class="token punctuation">;</span> <span class="token comment">// 5 minutes in milliseconds</span>

<span class="token comment">// ============================================</span>
<span class="token comment">// MAIN GBPY FUNCTION - USE THIS IN YOUR SHEETS</span>
<span class="token comment">// ============================================</span>

<span class="token comment">/**
 * Invoke Python functions from Google Sheets
 * @param {string} plugin - Plugin filename (e.g., "bs_plugin.py")
 * @param {string} func - Function name (e.g., "black_scholes")
 * @param {...*} args - Arguments (cell ranges, numbers, strings, dates)
 * @return {*} Result - Automatically spills arrays
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> func<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Validate server URL is configured</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>SERVER_BASE <span class="token operator">===</span> <span class="token string">"https://gbpy.loca.lt"</span> <span class="token operator">&amp;&amp;</span> SERVER_BASE<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"#ERROR: Please configure SERVER_BASE with your LocalTunnel URL"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Convert Google Sheets arguments to JSON-compatible format</span>
    <span class="token keyword">var</span> processedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">convertArgument</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Build payload (EXACT format as ExcelBridge expects)</span>
    <span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">:</span> <span class="token function">String</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">:</span> <span class="token function">String</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">,</span>
      args<span class="token punctuation">:</span> processedArgs
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Send request to Python server</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>INVOKE_PATH<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Extract and format result</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>result <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> response<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      
      <span class="token comment">// Handle different result types</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> result <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Table with headers</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">formatTableData</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 2D array</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">normalizeTo2D</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Object - return as JSON string</span>
        <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">// Scalar value (number, string, boolean)</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token string">"#ERROR: No result in response"</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ============================================</span>
<span class="token comment">// VARIANT FUNCTIONS - ExcelBridge API Compatibility</span>
<span class="token comment">// ============================================</span>

<span class="token comment">/**
 * Force array output format (equivalent to PYINVOKE_ARRAY)
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_ARRAY</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> func<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> processedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>convertArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">:</span> plugin<span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">:</span> func<span class="token punctuation">,</span>
      args<span class="token punctuation">:</span> processedArgs<span class="token punctuation">,</span>
      output_format<span class="token punctuation">:</span> <span class="token string">"excel_array"</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>INVOKE_PATH<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>result <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">normalizeTo2D</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"#ERROR: No array data"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Get raw JSON response (debugging)
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_JSON</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> func<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> processedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>convertArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">:</span> plugin<span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">:</span> func<span class="token punctuation">,</span>
      args<span class="token punctuation">:</span> processedArgs
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>INVOKE_PATH<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Ping Python server to check connectivity
 * @return {string} Connection status
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_PING</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpGet</span><span class="token punctuation">(</span>HEALTH_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>response <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">"ok"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">"✓ Python server connected - "</span> <span class="token operator">+</span> SERVER_BASE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">"⚠ Server responded but status not OK"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"✗ Connection failed: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Get list of available Python functions
 * @param {boolean} refresh - Force refresh cache (use TRUE to bypass cache)
 * @return {Array} 2D array of function catalog
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_FUNCTIONS</span><span class="token punctuation">(</span>refresh<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Check cache</span>
    <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>refresh <span class="token operator">&amp;&amp;</span> catalogCache <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastCatalogUpdate<span class="token punctuation">)</span> <span class="token operator">&lt;</span> CACHE_TIMEOUT<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> catalogCache<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Fetch from server</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpGet</span><span class="token punctuation">(</span>FUNCTIONS_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Format for Google Sheets</span>
    <span class="token keyword">var</span> output <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token string">"Plugin"</span><span class="token punctuation">,</span> <span class="token string">"Function"</span><span class="token punctuation">,</span> <span class="token string">"Description"</span><span class="token punctuation">,</span> <span class="token string">"Signature"</span><span class="token punctuation">,</span> <span class="token string">"Tags"</span><span class="token punctuation">,</span> <span class="token string">"SciPy"</span><span class="token punctuation">,</span> <span class="token string">"XGBoost"</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      response<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          func<span class="token punctuation">.</span>plugin <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">,</span>
          func<span class="token punctuation">.</span><span class="token keyword">function</span> <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">,</span>
          func<span class="token punctuation">.</span>description <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">,</span>
          func<span class="token punctuation">.</span>signature <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">,</span>
          Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>func<span class="token punctuation">.</span>tags<span class="token punctuation">)</span> <span class="token operator">?</span> func<span class="token punctuation">.</span>tags<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
          func<span class="token punctuation">.</span>is_scipy <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">,</span>
          func<span class="token punctuation">.</span>is_xgboost <span class="token operator">||</span> <span class="token string">""</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"No functions found"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Update cache</span>
    catalogCache <span class="token operator">=</span> output<span class="token punctuation">;</span>
    lastCatalogUpdate <span class="token operator">=</span> now<span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> output<span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Reload Python plugins
 * @return {string} Status message
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_RELOAD</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>RELOAD_PATH<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    catalogCache <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// Clear cache</span>
    <span class="token keyword">return</span> <span class="token string">"Plugins reloaded successfully"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Error reloading: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Debug function - inspect full server response
 * @return {Array} Debug information
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_DEBUG</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> func<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> processedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>convertArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">:</span> plugin<span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">:</span> func<span class="token punctuation">,</span>
      args<span class="token punctuation">:</span> processedArgs
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>INVOKE_PATH<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Format for readable display</span>
    <span class="token keyword">var</span> output <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token string">"=== GBPY DEBUG INFO ==="</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Server URL:"</span><span class="token punctuation">,</span> SERVER_BASE<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Plugin:"</span><span class="token punctuation">,</span> plugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Function:"</span><span class="token punctuation">,</span> func<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Arguments:"</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>processedArgs<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Status:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status <span class="token operator">||</span> <span class="token string">"OK"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Result Type:"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span> response<span class="token punctuation">.</span>result<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Has Data:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>result <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>result<span class="token punctuation">.</span>data <span class="token operator">?</span> <span class="token string">"Yes"</span> <span class="token punctuation">:</span> <span class="token string">"No"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">"Full Response:"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> output<span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ============================================</span>
<span class="token comment">// PRIVATE HELPER FUNCTIONS - DO NOT MODIFY</span>
<span class="token comment">// ============================================</span>

<span class="token comment">/**
 * HTTP GET request
 */</span>
<span class="token keyword">function</span> <span class="token function">httpGet</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> SERVER_BASE <span class="token operator">+</span> path<span class="token punctuation">;</span>
  <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    muteHttpExceptions<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
      <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'GBPY-GoogleSheets/2.2.8'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    timeout<span class="token punctuation">:</span> <span class="token number">30000</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> responseCode <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getResponseCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> content <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>responseCode <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> responseCode <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'HTTP '</span> <span class="token operator">+</span> responseCode <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> content<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * HTTP POST JSON request
 */</span>
<span class="token keyword">function</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> SERVER_BASE <span class="token operator">+</span> path<span class="token punctuation">;</span>
  <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    contentType<span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">,</span>
    muteHttpExceptions<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
      <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
      <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'GBPY-GoogleSheets/2.2.8'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    timeout<span class="token punctuation">:</span> <span class="token number">60000</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> responseCode <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getResponseCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> content <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>responseCode <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> responseCode <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'HTTP '</span> <span class="token operator">+</span> responseCode <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> content<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Convert Google Sheets argument to JSON-compatible format
 */</span>
<span class="token keyword">function</span> <span class="token function">convertArgument</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle 2D arrays (cell ranges)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Handle dates</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Handle numbers, strings, booleans</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> arg <span class="token operator">===</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Handle null/undefined</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> arg <span class="token operator">===</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Default: convert to string</span>
  <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Normalize arrays to 2D format for Google Sheets
 */</span>
<span class="token keyword">function</span> <span class="token function">normalizeTo2D</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>arr<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Already 2D with consistent columns</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Find maximum column count</span>
    <span class="token keyword">var</span> maxCols <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        maxCols <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxCols<span class="token punctuation">,</span> row<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        maxCols <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxCols<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Pad rows to equal length</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        row <span class="token operator">=</span> <span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">var</span> padded <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>padded<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> maxCols<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        padded<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> padded<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 1D array -&gt; convert to column vector</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Format table data with headers
 */</span>
<span class="token keyword">function</span> <span class="token function">formatTableData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token comment">// Add header row if present</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>header <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>header<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// Add data rows</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> normalized <span class="token operator">=</span> <span class="token function">normalizeTo2D</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    normalized<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> result<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> result <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"No data"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Handle large JSON responses in chunks
 * @customfunction
 */</span>
<span class="token keyword">function</span> <span class="token function">GBPY_JSON_CHUNKS</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> func<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> processedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>convertArgument<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">:</span> plugin<span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">:</span> func<span class="token punctuation">,</span>
      args<span class="token punctuation">:</span> processedArgs<span class="token punctuation">,</span>
      output_format<span class="token punctuation">:</span> <span class="token string">"json"</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token function">httpPost</span><span class="token punctuation">(</span>INVOKE_PATH<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> jsonStr <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Google Sheets cell limit is 50,000 characters</span>
    <span class="token keyword">var</span> CHUNK_SIZE <span class="token operator">=</span> <span class="token number">40000</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> jsonStr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> CHUNK_SIZE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>jsonStr<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i <span class="token operator">+</span> CHUNK_SIZE<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> chunks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> chunks <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"{}"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"#ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ============================================</span>
<span class="token comment">// UI MENU - Runs when spreadsheet opens</span>
<span class="token comment">// ============================================</span>

<span class="token comment">/**
 * Creates custom menu on spreadsheet open
 */</span>
<span class="token keyword">function</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ui <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ui<span class="token punctuation">.</span><span class="token function">createMenu</span><span class="token punctuation">(</span><span class="token string">'🐍 GBPY Python'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">'Ping Server'</span><span class="token punctuation">,</span> <span class="token string">'showPingStatus'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">'Reload Plugins'</span><span class="token punctuation">,</span> <span class="token string">'showReloadStatus'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">'Refresh Functions'</span><span class="token punctuation">,</span> <span class="token string">'refreshFunctions'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">'Help &amp; About'</span><span class="token punctuation">,</span> <span class="token string">'showAbout'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">addToUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">showPingStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> status <span class="token operator">=</span> <span class="token function">GBPY_PING</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Server Status'</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ButtonSet<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">showReloadStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> status <span class="token operator">=</span> <span class="token function">GBPY_RELOAD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Reload Plugins'</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ButtonSet<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">refreshFunctions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> sheet <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">GBPY_FUNCTIONS</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>length<span class="token punctuation">,</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValues</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Functions refreshed'</span><span class="token punctuation">,</span> <span class="token string">'Catalog written to A1'</span><span class="token punctuation">,</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ButtonSet<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">showAbout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>
    <span class="token string">'GBPY for Google Sheets v2.2.8'</span><span class="token punctuation">,</span>
    <span class="token string">'Google Sheets client for ExcelBridge Python server\n\n'</span> <span class="token operator">+</span>
    <span class="token string">'Server URL: '</span> <span class="token operator">+</span> SERVER_BASE <span class="token operator">+</span> <span class="token string">'\n\n'</span> <span class="token operator">+</span>
    <span class="token string">'Available functions:\n'</span> <span class="token operator">+</span>
    <span class="token string">'• =GBPY() - Main function\n'</span> <span class="token operator">+</span>
    <span class="token string">'• =GBPY_ARRAY() - Force array output\n'</span> <span class="token operator">+</span>
    <span class="token string">'• =GBPY_PING() - Test connection\n'</span> <span class="token operator">+</span>
    <span class="token string">'• =GBPY_FUNCTIONS() - List Python functions\n'</span> <span class="token operator">+</span>
    <span class="token string">'• =GBPY_DEBUG() - Inspect responses\n\n'</span> <span class="token operator">+</span>
    <span class="token string">'Documentation: https://excelbridge.dev'</span><span class="token punctuation">,</span>
    SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getUi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ButtonSet<span class="token punctuation">.</span>OK
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="save-and-authorize"><strong>4.3 Save and Authorize</strong></h3>
<ol>
<li>Click <strong>Save</strong> (💾 icon)</li>
<li>Name your project: <strong>"GBPY Client"</strong></li>
<li>Click <strong>Run</strong> (▶️) and select <code>onOpen</code></li>
<li><strong>Authorize</strong> the script:
<ul>
<li>Review permissions</li>
<li>Click “Advanced” → “Go to GBPY Client (unsafe)”</li>
<li>Click “Allow”</li>
</ul>
</li>
</ol>
<hr>
<h2 id="✅-step-5-verify-installation">✅ <strong>Step 5: Verify Installation</strong></h2>
<h3 id="test-the-connection"><strong>5.1 Test the Connection</strong></h3>
<p>In your Google Sheet, type:</p>
<pre><code>=GBPY_PING()
</code></pre>
<p><strong>Expected result:</strong> <code>✓ Python server connected - https://gbpy.loca.lt</code></p>
<h3 id="test-a-simple-function"><strong>5.2 Test a Simple Function</strong></h3>
<pre><code>=GBPY("math_plugin.py", "add", 2, 3)
</code></pre>
<p><strong>Expected result:</strong> <code>5</code></p>
<h3 id="list-available-functions"><strong>5.3 List Available Functions</strong></h3>
<pre><code>=GBPY_FUNCTIONS(TRUE)
</code></pre>
<p><strong>Expected result:</strong> Table of all your Python plugins and functions</p>
<hr>
<h2 id="🎯-usage-examples">🎯 <strong>Usage Examples</strong></h2>

<table>
<thead>
<tr>
<th>Task</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Black-Scholes</strong></td>
<td><code>=GBPY("bs_plugin.py", "black_scholes", 100, 100, 0.2, 0.05, 0.02, 1, "call")</code></td>
</tr>
<tr>
<td><strong>Read CSV</strong></td>
<td><code>=GBPY("pandas_plugin.py", "read_csv", "data.csv")</code></td>
</tr>
<tr>
<td><strong>Train Model</strong></td>
<td><code>=GBPY_ARRAY("sklearn_plugin.py", "train", A2:B100, C2:C100)</code></td>
</tr>
<tr>
<td><strong>Plot Chart</strong></td>
<td><code>=GBPY("plot_plugin.py", "histogram", A2:A100, "Histogram", "Value", "Frequency")</code></td>
</tr>
<tr>
<td><strong>Numpy Array</strong></td>
<td><code>=GBPY_ARRAY("numpy_plugin.py", "linspace", 0, 10, 5)</code></td>
</tr>
</tbody>
</table><hr>
<h2 id="🔍-troubleshooting">🔍 <strong>Troubleshooting</strong></h2>

<table>
<thead>
<tr>
<th>Symptom</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>✗ Connection failed</code></td>
<td>Tunnel not running</td>
<td>Run <code>npx localtunnel --port 8765 --subdomain gbpy</code></td>
</tr>
<tr>
<td><code>#ERROR: SERVER_BASE not configured</code></td>
<td>Wrong URL in script</td>
<td>Update <code>SERVER_BASE</code> to your LocalTunnel URL</td>
</tr>
<tr>
<td><code>502 Bad Gateway</code></td>
<td>Tunnel can’t reach server</td>
<td>Check ExcelBridge.exe is running on port 8765</td>
</tr>
<tr>
<td><code>Execution time exceeded</code></td>
<td>Function &gt; 30 seconds</td>
<td>Use GBPY_JSON_CHUNKS() or optimize Python code</td>
</tr>
<tr>
<td><code>Subdomain already taken</code></td>
<td>“gbpy” in use</td>
<td>Try <code>gbpy1</code>, <code>gbpy2</code>, <code>excelbridge</code>, <code>pybridge</code></td>
</tr>
</tbody>
</table><hr>
<h2 id="📊-architecture-overview">📊 <strong>Architecture Overview</strong></h2>
<pre><code>┌─────────────┐     HTTPS      ┌──────────────┐     HTTP      ┌─────────────────┐
│   Google    │ ────────────&gt;  │ LocalTunnel  │ ───────────&gt;  │  ExcelBridge    │
│   Sheets    │  (Public URL)  │  (gbpy.loca.lt) │  (Port 80)  │  Python Server  │
└─────────────┘                └──────────────┘               │  (localhost:8765)│
                                                              └─────────────────┘
                                                                       │
                                                              ┌────────▼────────┐
                                                              │  Your Plugins   │
                                                              │  bs_plugin.py   │
                                                              │  pandas_plugin.py│
                                                              └─────────────────┘
</code></pre>
<hr>
<h2 id="📚-quick-reference-card">📚 <strong>Quick Reference Card</strong></h2>
<h3 id="two-windows-to-keep-running"><strong>Two Windows to Keep Running:</strong></h3>
<pre><code>WINDOW 1 - EXCELBRIDGE          |  WINDOW 2 - TUNNEL
────────────────────────────────|────────────────────────────────
cd ExcelBridge_v2_2_8_portable  |  npx localtunnel --port 8765
ExcelBridge.exe                 |  --subdomain gbpy
                                |
Keep running! Never close!      |  Keep running! Never close!
</code></pre>
<h3 id="google-sheets-functions"><strong>Google Sheets Functions:</strong></h3>
<pre><code>=GBPY_PING()                                    - Test connection
=GBPY("plugin.py", "func", args)               - Call any function
=GBPY_ARRAY("plugin.py", "func", range)        - Force array output
=GBPY_FUNCTIONS()                              - List all functions
=GBPY_DEBUG("plugin.py", "func", args)         - Debug mode
</code></pre>
<hr>
<h2 id="⚠️-important-notes">⚠️ <strong>Important Notes</strong></h2>
<ol>
<li><strong>Both windows must remain open</strong> - Closing either stops the connection</li>
<li><strong>URL changes on restart</strong> - Update <code>SERVER_BASE</code> in Apps Script each time</li>
<li><strong>30-second limit</strong> - Google Sheets custom functions timeout at 30 seconds</li>
<li><strong>No VBA</strong> - This is Google Apps Script (JavaScript), not Excel VBA</li>
<li><strong>Same Python server</strong> - Your existing plugins work without modification</li>
</ol>
<hr>
<h2 id="🚀-pro-tips">🚀 <strong>Pro Tips</strong></h2>
<h3 id="persistent-subdomain-paid"><strong>Persistent Subdomain (Paid)</strong></h3>
<pre class=" language-cmd"><code class="prism  language-cmd">npx localtunnel --port 8765 --subdomain your-company-name
</code></pre>
<p>Upgrade at <a href="https://localtunnel.me">https://localtunnel.me</a></p>
<h3 id="batch-processing-for-large-data"><strong>Batch Processing for Large Data</strong></h3>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Use menu instead of cell function for &gt;30 sec operations</span>
<span class="token keyword">function</span> <span class="token function">runLongCalculation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">GBPY</span><span class="token punctuation">(</span><span class="token string">"ml_plugin.py"</span><span class="token punctuation">,</span> <span class="token string">"train_model"</span><span class="token punctuation">,</span> rangeValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Write result to sheet</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="auto-refresh-tunnel"><strong>Auto-refresh Tunnel</strong></h3>
<p>Create <code>start_tunnel.bat</code>:</p>
<pre class=" language-batch"><code class="prism  language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token label property">:loop</span>
<span class="token command"><span class="token keyword">npx</span> localtunnel <span class="token parameter attr-name">--port</span> <span class="token number">8765</span> <span class="token parameter attr-name">--subdomain</span> gbpy</span>
<span class="token command"><span class="token keyword">echo</span> Tunnel crashed! Restarting in <span class="token number">5</span> seconds...</span>
<span class="token command"><span class="token keyword">timeout</span> <span class="token parameter attr-name">/t</span> <span class="token number">5</span></span>
<span class="token command"><span class="token keyword">goto</span> loop</span>
</code></pre>
<hr>
<p><strong>End of Google Sheets Integration Addendum</strong></p>
<p><em>ExcelBridge v2.2.8 - Compatible with all existing Python plugins</em></p>
</div>
</body>

</html>
